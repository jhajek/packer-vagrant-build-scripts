# Instruction to build OVA to EC2 instance

This document will walk you through the sample code to build and load/import an OVA file generated by Packer into AWS.

Packer Docs located at: [https://packer.io/docs/post-processors/amazon-import.html](https://packer.io/docs/post-processors/amazon-import.html "Documentation for AWS importer")

https://packer.io/docs/templates/user-variables.html

What the packer post-processor is doing is essentially running this:  https://docs.aws.amazon.com/vm-import/latest/userguide/vmimport-image-import.html

## Pre-req steps to set up AWS configuration

Follow these steps first:
https://docs.aws.amazon.com/vm-import/latest/userguide/vmie_prereqs.html#vmimport-role

## Set export mode to OVA

[https://packer.io/docs/builders/virtualbox-iso.html](https://packer.io/docs/builders/virtualbox-iso.html "Packer documentation on how to build a virtualbox artifact as OVA).

The OVA format is part of the [Open Virtualization Format](https://en.wikipedia.org/wiki/Open_Virtualization_Format "Wikipedia OVF deescription page")

```json
 "format": "ova",
 ```

The above line was added to this template so the AWS importer (which requires OVA) would work.

## How to get AWS Keys Securely into Packer

There are a few ways to do this.  I will show you one here, but there are much more secure and manageable ways to do this (see [Hashicorp Vault](https://www.vaultproject.io/ "Website for Vault secret management")).

Copy the file: ```variables-sample.json``` into a file named ```variables.json```.  This will give you a template along with having a file that will pass environment variables into the Packer build process.
